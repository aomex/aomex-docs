import{_ as o,r as c,o as r,c as p,a as n,d as s,b as a,f as t}from"./app-fa9144ea.js";const i={},l=n("h1",{id:"压缩内容",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#压缩内容","aria-hidden":"true"},"#"),s(" 压缩内容")],-1),d={href:"https://www.gzip.org",target:"_blank",rel:"noopener noreferrer"},u={href:"https://github.com/google/brotli",target:"_blank",rel:"noopener noreferrer"},h=n("h2",{id:"安装",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#安装","aria-hidden":"true"},"#"),s(" 安装")],-1),m={href:"https://www.npmjs.com/package/@aomex/compress",target:"_blank",rel:"noopener noreferrer"},k=n("img",{src:"https://img.shields.io/npm/v/@aomex/compress?logo=npm&label=@aomex/compress",alt:"npm"},null,-1),b=t(`<div class="language-bash" data-ext="sh"><pre class="language-bash"><code><span class="token function">pnpm</span> <span class="token function">add</span> @aomex/compress
</code></pre></div><h2 id="使用" tabindex="-1"><a class="header-anchor" href="#使用" aria-hidden="true">#</a> 使用</h2><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">// ./src/chains/web.chain.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> compress <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@aomex/compress&#39;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> appChain <span class="token operator">=</span> chain<span class="token punctuation">.</span>web<span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token function">compress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="设置属性" tabindex="-1"><a class="header-anchor" href="#设置属性" aria-hidden="true">#</a> 设置属性</h2><h3 id="filter" tabindex="-1"><a class="header-anchor" href="#filter" aria-hidden="true">#</a> filter</h3>`,5),_=n("strong",null,"类型：",-1),g=n("code",null,"(contentType: string) => boolean",-1),f=n("br",null,null,-1),v=n("strong",null,"默认值：",-1),x={href:"https://www.npmjs.com/package/compressible",target:"_blank",rel:"noopener noreferrer"},w=t(`<p>根据响应的<code>content-type</code>确定是否需要压缩。如果存在<code>ctx.needCompress=true</code>，则该属性会被直接忽略<br></p><h3 id="threshold" tabindex="-1"><a class="header-anchor" href="#threshold" aria-hidden="true">#</a> threshold</h3><p><strong>类型：</strong> <code>number</code> | <code>string</code><br><strong>默认值：</strong> 1024<br> 最低要求的压缩体积。数字或者不带单位时，单位为<code>byte</code>。也可以传入带单位的字符串。</p><ul><li>1259</li><li>&#39;1024&#39;</li><li>&#39;100byte&#39;</li><li>&#39;23kb&#39;</li><li>&#39;1024mb&#39;</li><li>&#39;3gb&#39;</li></ul><h2 id="导出参数" tabindex="-1"><a class="header-anchor" href="#导出参数" aria-hidden="true">#</a> 导出参数</h2><h3 id="needcompress" tabindex="-1"><a class="header-anchor" href="#needcompress" aria-hidden="true">#</a> needCompress</h3><p><strong>类型：</strong> boolean<br><strong>默认值：</strong> false<br></p><p>插件暴露出来的属性，允许响应<code>强制开启</code>压缩功能<br></p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code>router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/users&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token function">action</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ctx<span class="token punctuation">.</span>needCompress <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,9);function y(C,N){const e=c("ExternalLinkIcon");return r(),p("div",null,[l,n("p",null,[s("Web请求响应体积太大时，会消耗额外的服务器带宽以及花费更多时间用于内容的下载，甚至影响到用户的访问体验。因此我们希望使用"),n("a",d,[s("gzip"),a(e)]),s("或者"),n("a",u,[s("brotli"),a(e)]),s("算法压缩响应内容的体积。")]),h,n("p",null,[n("a",m,[k,a(e)])]),b,n("p",null,[_,s(),g,f,v,s(),n("a",x,[s("compressible"),a(e)])]),w])}const B=o(i,[["render",y],["__file","compress.html.vue"]]);export{B as default};
